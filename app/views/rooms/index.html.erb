<p id="notice"><%= notice %></p>

<% start_date = params.fetch(:start_date, Date.today).to_date%>
<% date_range = (start_date.beginning_of_month.beginning_of_week..start_date.end_of_month.end_of_week).to_a %>


<table>
  <thead>
    <tr>
      <% date_range.slice(0,7).each do |day| %>
      <th><%= I18n.t("date.abbr_day_names")[day.wday] %></th>
      <% end %>
    </tr>
  </thead>

  <tbody>
  <% date_range.each_slice(7) do |week| %>
    <tr>
      <% week.each do |day| %>
      <td>
      <%= day %>
      <% @bookings.select {|b| b.date_in.to_date == day}.each do |meeting| %>
        <div><%= link_to meeting.description, meeting %></div>
      <% end %>
    </td>
    <% end %>
    </tr>
    <% end %>
  </tbody>
</table>


<table>
  <thead>
    <tr>
      <th>Time</th>
      <% @rooms.each do |room| %>
          <th class="Room name"><%= link_to room.name, room %></th>
      <% end %>
    </tr>
      <% i = 9.00 %>
      <% 17.times do |row| %>
        <tr>
          <% if i % 1 ==0 %>
            <td class="timeCell"><%= number_with_precision i, :precision => 2 %></td>
            <% @rooms.each do |room| %>
              <td class="roomCell" id="<%= room.name %>" data-num="<%= number_with_precision i, :precision =>2  %>">-</td>
            <% end %>
            <% i += 0.30 %>
          <% else %>
          <td class="timeCell"> <%=  number_with_precision i, :precision => 2  %></td>
          <% @rooms.each do |room| %>
            <td class="roomCell" id="<%= room.name %>" data-num="<%= number_with_precision i, :precision =>2  %>">-</td>
          <% end %>
            <% i += 0.70 %>
        <% end %>
        </tr>
      <% end %>
      <th colspan="3"></th>
    </tr>
  </thead>
</table>

<br>

<%= link_to 'New Room', new_room_path %>
<%= link_to 'New Booking', new_booking_path, id: "form"%>
